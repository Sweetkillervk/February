const quizData = 
[
  {
    question: "KYP में कुल कितने सेशन होते हैं?",
    a: "60",
    b: "40",
    c: "120",
    d: "20",
    correct: "C"
  },
  {
    question: "KYP कोर्स कितने घंटे का होता है?",
    a: "120",
    b: "240",
    c: "80",
    d: "इनमें से कोई नहीं",
    correct: "B"
  },
  {
    question: "ERA सॉफ्टवेयर किस कंपनी ने बनाया है?",
    a: "BSDM",
    b: "MKCL",
    c: "MCSK",
    d: "ये सभी",
    correct: "B"
  },
  {
    question: "कीबोर्ड, माउस, डिस्प्ले, और सिस्टम यूनिट क्या हैं?",
    a: "हार्डवेयर",
    b: "स्टोरेज डिवाइस",
    c: "आउटपुट डिवाइस",
    d: "सॉफ्टवेयर",
    correct: "A"
  },
  {
    question: "कंप्यूटर क्या है?",
    a: "एक इनपुट डिवाइस",
    b: "एक आउटपुट डिवाइस",
    c: "एक ऑपरेटिंग सिस्टम",
    d: "एक इलेक्ट्रॉनिक डिवाइस जो डेटा प्रोसेस करता है",
    correct: "D"
  },
  {
    question: "CIT में कुल कितने सेशन होते हैं?",
    a: "120",
    b: "60",
    c: "80",
    d: "20",
    correct: "B"
  },
  {
    question: "CIT सेशन के अंत में कितने प्रैक्टिकल प्रश्न होते हैं?",
    a: "5",
    b: "4",
    c: "10",
    d: "15",
    correct: "B"
  },
  {
    question: "CIS में कितने सेशन होते हैं?",
    a: "20",
    b: "120",
    c: "40",
    d: "60",
    correct: "C"
  },
  {
    question: "CSS में कितने सेशन होते हैं?",
    a: "20",
    b: "120",
    c: "40",
    d: "60",
    correct: "A"
  },
  {
    question: "Apple Watch किस प्रकार का कंप्यूटर है?",
    a: "लैपटॉप",
    b: "टैबलेट",
    c: "स्मार्टफोन",
    d: "वियरेबल",
    correct: "D"
  },
  {
    question: "एक दिन में कितने सेशन कंप्लीट होते हैं?",
    a: "4",
    b: "6",
    c: "2",
    d: "8",
    correct: "C"
  },
  {
    question: "KYP कोर्स कुल कितने दिनों का होता है?",
    a: "120",
    b: "80",
    c: "90",
    d: "60",
    correct: "C"
  },
  {
    question: "CIT कितने घंटे का कोर्स है?",
    a: "60",
    b: "120",
    c: "40",
    d: "80",
    correct: "B"
  },
  {
    question: "CLS कितने घंटे का कोर्स है?",
    a: "60",
    b: "120",
    c: "40",
    d: "80",
    correct: "D"
  },
  {
    question: "CIT क्लिकर में कितने प्रश्न होते हैं?",
    a: "5",
    b: "6",
    c: "10",
    d: "4",
    correct: "A"
  },
  {
    question: "KYP कोर्स किस विभाग के अंतर्गत आता है?",
    a: "श्रम विभाग",
    b: "शिक्षा विभाग",
    c: "RTPS विभाग",
    d: "ये सभी",
    correct: "A"
  },
  {
    question: "CPU का पूरा नाम क्या है?",
    a: "Central Program Unit",
    b: "Central Processing Unit",
    c: "Computer Processing Unit",
    d: "Control Processing Unit",
    correct: "B"
  },
  {
    question: "RAM और ROM में क्या अंतर है?",
    a: "दोनों अस्थायी मेमोरी हैं",
    b: "दोनों स्थायी मेमोरी हैं",
    c: "RAM अस्थायी और ROM स्थायी मेमोरी है",
    d: "RAM स्थायी और ROM अस्थायी मेमोरी है",
    correct: "C"
  },
  {
    question: "HDD और SSD में क्या अंतर है?",
    a: "HDD तेज़ होती है",
    b: "SSD धीमी होती है",
    c: "HDD टिकाऊ होती है",
    d: "SSD तेज़ और टिकाऊ होती है",
    correct: "D"
  },
  {
    question: "Windows और Linux में क्या अंतर है?",
    a: "दोनों ओपन-सोर्स हैं",
    b: "दोनों कम सुरक्षित हैं",
    c: "Windows यूजर-फ्रेंडली है, Linux ओपन-सोर्स है",
    d: "Linux केवल मोबाइल में चलता है",
    correct: "C"
  },
  {
    question: "Notepad किस प्रकार का सॉफ्टवेयर है?",
    a: "ब्राउज़र",
    b: "टेक्स्ट एडिटर",
    c: "गेमिंग सॉफ्टवेयर",
    d: "एंटीवायरस",
    correct: "B"
  },
  {
    question: "Ctrl + C किसके लिए उपयोग किया जाता है?",
    a: "कट करने के लिए",
    b: "पेस्ट करने के लिए",
    c: "कॉपी करने के लिए",
    d: "सेव करने के लिए",
    correct: "C"
  },
  {
    question: "Ctrl + V का क्या कार्य है?",
    a: "कट",
    b: "कॉपी",
    c: "सेव",
    d: "पेस्ट",
    correct: "D"
  },
  {
    question: "कंप्यूटर का फुल फॉर्म क्या है?",
    a: "Common Operating Machine Used for Technical and Educational Research",
    b: "Computer Operating Machine Unit",
    c: "Central Operating Machine Purposely Used for Research",
    d: "कोई आधिकारिक फुल फॉर्म नहीं है",
    correct: "D"
  },
  {
    question: "Bit और Byte में क्या अंतर है?",
    a: "दोनों बराबर होते हैं",
    b: "1 Byte = 4 Bits",
    c: "Bit छोटी इकाई है और 1 Byte = 8 Bits",
    d: "Bit बड़ी इकाई है",
    correct: "C"
  },
  {
    question: "मदरबोर्ड क्या होता है?",
    a: "एक प्रकार का कीबोर्ड",
    b: "एक इनपुट डिवाइस",
    c: "कंप्यूटर का बाहरी हिस्सा",
    d: "मुख्य सर्किट बोर्ड",
    correct: "D"
  },
  {
    question: "BIOS का पूरा नाम क्या है?",
    a: "Basic Integrated Output System",
    b: "Binary Input Output System",
    c: "Basic Input Output System",
    d: "Basic Input Over System",
    correct: "C"
  },
  {
    question: "USB का पूरा नाम क्या है?",
    a: "Universal System Bus",
    b: "Uniform Serial Bus",
    c: "Unified Serial Bus",
    d: "Universal Serial Bus",
    correct: "D"
  },
  {
    question: "IP Address क्या होता है?",
    a: "एक वेबसाइट",
    b: "एक ईमेल आईडी",
    c: "एक यूनिक पहचान संख्या",
    d: "एक पासवर्ड",
    correct: "C"
  },
  {
    question: "Wi-Fi का पूरा नाम क्या है?",
    a: "Wireless Finder",
    b: "Wired Fidelity",
    c: "Wireless Fidelity",
    d: "Wide Frequency",
    correct: "C"
  },
  {
    question: "LAN और WAN में क्या अंतर है?",
    a: "दोनों लोकल नेटवर्क हैं",
    b: "LAN बड़ा और WAN छोटा होता है",
    c: "LAN लोकल और WAN बड़ा नेटवर्क होता है",
    d: "दोनों एक जैसे होते हैं",
    correct: "C"
  },
  {
    question: "Firewall क्या होता है?",
    a: "डाटा स्टोरेज डिवाइस",
    b: "प्रिंटर",
    c: "नेटवर्क सुरक्षा प्रणाली",
    d: "ऑपरेटिंग सिस्टम",
    correct: "C"
  },
  {
    question: "Cloud Computing क्या है?",
    a: "एक गेम",
    b: "इंटरनेट स्टोरेज तकनीक",
    c: "एक ब्राउज़र",
    d: "एक प्रोग्रामिंग लैंग्वेज",
    correct: "B"
  },
  {
    question: "कंप्यूटर वायरस क्या होता है?",
    a: "एंटीवायरस प्रोग्राम",
    b: "एक हानिकारक प्रोग्राम",
    c: "एक नेटवर्क डिवाइस",
    d: "एक ड्राइवर",
    correct: "B"
  },
  {
    question: "VPN का पूरा नाम क्या है?",
    a: "Virtual Process Network",
    b: "Verified Private Network",
    c: "Virtual Private Network",
    d: "Video Private Network",
    correct: "C"
  },
  {
    question: "Cache Memory क्या होती है?",
    a: "एक आउटपुट डिवाइस",
    b: "एक सामान्य स्टोरेज",
    c: "हाई-स्पीड मेमोरी",
    d: "ROM का दूसरा नाम",
    correct: "C"
  },
  {
    question: "Operating System क्या होता है?",
    a: "हार्ड डिस्क",
    b: "एक यूज़र",
    c: "हार्डवेयर",
    d: "हार्डवेयर और यूज़र के बीच इंटरफेस",
    correct: "D"
  },
  {
    question: "कंप्यूटर में नेटवर्किंग क्यों आवश्यक है?",
    a: "इंटरनेट चलाने के लिए",
    b: "गेम खेलने के लिए",
    c: "डाटा साझा करने के लिए",
    d: "फॉर्मेट करने के लिए",
    correct: "C"
  },
  {
    question: "HTTP और HTTPS में क्या अंतर है?",
    a: "कोई अंतर नहीं",
    b: "HTTP सुरक्षित है",
    c: "HTTPS असुरक्षित है",
    d: "HTTPS में डेटा एन्क्रिप्ट होता है",
    correct: "D"
  },
  {
    question: "IP Address के प्रकार कितने होते हैं?",
    a: "1",
    b: "2 - IPv4 और IPv6",
    c: "3",
    d: "कोई नहीं",
    correct: "B"
  },
  {
    question: "Router क्या होता है?",
    a: "इनपुट डिवाइस",
    b: "आउटपुट डिवाइस",
    c: "नेटवर्क कनेक्शन काटने वाला",
    d: "नेटवर्क जोड़ने और डेटा भेजने वाला डिवाइस",
    correct: "D"
  },
  {
    question: "Compiler क्या होता है?",
    a: "एक हार्डवेयर",
    b: "एक ब्राउज़र",
    c: "एक प्रोग्राम जो कोड को मशीन भाषा में बदलता है",
    d: "एक वायरस",
    correct: "C"
  },
  {
    question: "SSD का फुल फॉर्म क्या है?",
    a: "Solid Soft Drive",
    b: "Simple System Drive",
    c: "Solid State Drive",
    d: "Static Storage Device",
    correct: "C"
  },
  {
    question: "SMTP का पूरा नाम क्या है?",
    a: "Simple Mail Text Protocol",
    b: "Secure Mail Transfer Protocol",
    c: "Simple Mail Transfer Protocol",
    d: "Static Mail Transfer Protocol",
    correct: "C"
  },
  {
    question: "कंप्यूटर में Cache का उपयोग क्यों किया जाता है?",
    a: "डेटा को फॉर्मेट करने के लिए",
    b: "स्पीड बढ़ाने के लिए",
    c: "वायरस हटाने के लिए",
    d: "बैकअप लेने के लिए",
    correct: "B"
  },
  {
    question: "Bluetooth क्या है?",
    a: "एक सॉफ्टवेयर",
    b: "वायरलेस तकनीक",
    c: "वायरस",
    d: "ऑपरेटिंग सिस्टम",
    correct: "B"
  },
  {
    question: "DNS का पूरा नाम क्या है?",
    a: "Domain Network System",
    b: "Data Name System",
    c: "Domain Name System",
    d: "Digital Network Server",
    correct: "C"
  },
  {
    question: "HTML का पूरा नाम क्या है?",
    a: "HyperText Making Language",
    b: "HighText Markup Language",
    c: "HyperText Markup Language",
    d: "High Transfer Markup Language",
    correct: "C"
  },
  {
    question: "Backup क्यों आवश्यक है?",
    a: "वायरस फैलाने के लिए",
    b: "फॉर्मेटिंग के लिए",
    c: "डाटा सुरक्षित रखने के लिए",
    d: "इंटरनेट चलाने के लिए",
    correct: "C"
  }
];


// Allowed Learner Codes
const validLearnerCodes = ["7841", "9298", "9108", "5305", "1747", "3830", "7912", "2719", "2020", "5655", "7929", "7274", "4664", "4130", "2413", "3249", "5836", "9853", "9852"]; // Yahan apne learner codes add karo

// DOM Elements
const loginForm = document.getElementById('loginForm');
const quizSection = document.getElementById('quizSection');
const marksheet = document.getElementById('marksheet');
const answerEls = document.querySelectorAll('.answer');
const questionEl = document.getElementById('question');
const a_text = document.getElementById('a_text');
const b_text = document.getElementById('b_text');
const c_text = document.getElementById('c_text');
const d_text = document.getElementById('d_text');
const submitBtn = document.getElementById('submit');
const studentName = document.getElementById('studentName');
const studentEmail = document.getElementById('studentEmail');
const learnerCode = document.getElementById('learnerCode');
const timerElement = document.getElementById('timer');
const resetButton = document.getElementById('resetButton');
const marksheetName = document.getElementById('marksheetName');
const marksheetEmail = document.getElementById('marksheetEmail');
const marksheetCode = document.getElementById('marksheetCode');
const marksheetScore = document.getElementById('marksheetScore');
const studentTableBody = document.getElementById('studentTableBody');

let currentQuiz = 0;
let score = 0;
let shuffledQuizData = [];
let timeLeft = 30;
let timerInterval;

// Shuffle function
function shuffle(array) {
  let currentIndex = array.length, randomIndex;
  while (currentIndex != 0) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }
  return array;
}

// Handle Login and Store Data
function handleLogin() {
  const name = studentName.value.trim();
  const email = studentEmail.value.trim();
  const learnerCodeValue = learnerCode.value.trim();

  if (name && email && learnerCodeValue) {

    // ✅ Learner code validation
    if (!validLearnerCodes.includes(learnerCodeValue)) {
      alert("गलत Learner Code. कृपया सही कोड दर्ज करें।");
      return;
    }

    // Store user data in sessionStorage
    sessionStorage.setItem('studentName', name);
    sessionStorage.setItem('studentEmail', email);
    sessionStorage.setItem('learnerCode', learnerCodeValue);

    // Hide login and show quiz section
    loginForm.style.display = 'none';
    quizSection.style.display = 'block';

    // Set marksheet fields
    marksheetName.value = name;
    marksheetEmail.value = email;
    marksheetCode.value = learnerCodeValue;

    // Shuffle quiz data and load quiz
    shuffledQuizData = shuffle([...quizData]);
    loadQuiz();
  } else {
    alert("कृपया सभी फ़ील्ड्स भरें।");
  }
}

// Load Quiz Data
function loadQuiz() {
  deselectAnswers();
  const currentQuizData = shuffledQuizData[currentQuiz];
  questionEl.innerText = `Q${currentQuiz + 1}: ${currentQuizData.question}`;
  a_text.innerText = currentQuizData.a;
  b_text.innerText = currentQuizData.b;
  c_text.innerText = currentQuizData.c;
  d_text.innerText = currentQuizData.d;

  timeLeft = 30;
  updateTimer();
  startTimer();
}

// Deselect Answers
function deselectAnswers() {
  answerEls.forEach(answerEl => (answerEl.checked = false));
}

// Get Selected Answer
function getSelected() {
  let answer;
  answerEls.forEach(answerEl => {
    if (answerEl.checked) {
      answer = answerEl.id;
    }
  });
  return answer;
}

// Start Timer
function startTimer() {
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    if (timeLeft > 0) {
      timeLeft--;
      updateTimer();
    } else {
      clearInterval(timerInterval);
      currentQuiz++;
      if (currentQuiz < shuffledQuizData.length) {
        loadQuiz();
      } else {
        showMarksheet();
      }
    }
  }, 1000);
}

// Update Timer
function updateTimer() {
  timerElement.innerText = `Time: ${timeLeft}s`;
  if (timeLeft <= 5) {
    timerElement.classList.add('warning');
  } else {
    timerElement.classList.remove('warning');
  }
}

// Submit Answer
submitBtn.addEventListener('click', () => {
  const answer = getSelected();
  if (answer) {
    if (answer === shuffledQuizData[currentQuiz].correct) {
      score++;
    }
    currentQuiz++;
    if (currentQuiz < shuffledQuizData.length) {
      loadQuiz();
    } else {
      showMarksheet();
    }
  } else {
    alert("कृपया उत्तर चुनें।");
  }
});

// Show Marksheet
function showMarksheet() {
  clearInterval(timerInterval);
  quizSection.style.display = 'none';
  marksheet.style.display = 'block';

  // Set score in marksheet
  marksheetScore.value = `आपने ${score}/${shuffledQuizData.length} प्रश्न सही उत्तर दिए।`;

  // Add record to student records table
  const row = document.createElement('tr');
  row.innerHTML = `
    <td>${sessionStorage.getItem('studentName')}</td>
    <td>${sessionStorage.getItem('studentEmail')}</td>
    <td>${sessionStorage.getItem('learnerCode')}</td>
    <td>${score}</td>
  `;
  studentTableBody.appendChild(row);
}

// Reset Quiz
function resetQuiz() {
  loginForm.style.display = 'block';
  marksheet.style.display = 'none';
  studentName.value = '';
  studentEmail.value = '';
  learnerCode.value = '';
  score = 0;
  currentQuiz = 0;
  clearInterval(timerInterval);
  timerElement.innerText = 'Time: 30s';
}

// Event Listeners
document.getElementById('loginButton').addEventListener('click', handleLogin);
resetButton.addEventListener('click', resetQuiz);