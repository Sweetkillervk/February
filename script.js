const quizData = 
[
  
  {
    question: "MS Word किस प्रकार का सॉफ्टवेयर है?",
    a: "सिस्टम सॉफ्टवेयर",
    b: "ऑपरेटिंग सिस्टम",
    c: "एप्लिकेशन सॉफ्टवेयर",
    d: "गेमिंग सॉफ्टवेयर",
    correct: "c"
  },
  {
    question: "Home Tab में 'Bold' का शॉर्टकट क्या है?",
    a: "Ctrl + I",
    b: "Ctrl + U",
    c: "Ctrl + B",
    d: "Ctrl + L",
    correct: "c"
  },
  {
    question: "MS Word में टेक्स्ट को इटैलिक करने का शॉर्टकट क्या है?",
    a: "Ctrl + B",
    b: "Ctrl + I",
    c: "Ctrl + U",
    d: "Ctrl + E",
    correct: "b"
  },
  {
    question: "'Justify' alignment किस शॉर्टकट से होता है?",
    a: "Ctrl + R",
    b: "Ctrl + E",
    c: "Ctrl + J",
    d: "Ctrl + L",
    correct: "c"
  },
  {
    question: "Home Tab में कौन-सा ग्रुप फॉन्ट साइज़ को नियंत्रित करता है?",
    a: "Styles",
    b: "Paragraph",
    c: "Clipboard",
    d: "Font",
    correct: "d"
  },
  {
    question: "Bullets किस ग्रुप में पाए जाते हैं?",
    a: "Clipboard",
    b: "Paragraph",
    c: "Font",
    d: "Editing",
    correct: "b"
  },
  {
    question: "Underline करने का शॉर्टकट क्या है?",
    a: "Ctrl + B",
    b: "Ctrl + I",
    c: "Ctrl + U",
    d: "Ctrl + T",
    correct: "c"
  },
  {
    question: "Text को Highlight करने का विकल्प किस ग्रुप में होता है?",
    a: "Font",
    b: "Paragraph",
    c: "Editing",
    d: "Styles",
    correct: "a"
  },
  {
    question: "'Cut' करने का शॉर्टकट क्या है?",
    a: "Ctrl + C",
    b: "Ctrl + V",
    c: "Ctrl + X",
    d: "Ctrl + Z",
    correct: "c"
  },
  {
    question: "Home Tab में 'Styles' का मुख्य उद्देश्य क्या है?",
    a: "Clipboard मैनेज करना",
    b: "Text formatting",
    c: "Formatting consistency",
    d: "Undo और Redo करना",
    correct: "c"
  },
  {
    question: "Text को 'Center Align' करने के लिए किस शॉर्टकट का प्रयोग होता है?",
    a: "Ctrl + C",
    b: "Ctrl + E",
    c: "Ctrl + L",
    d: "Ctrl + R",
    correct: "b"
  },
  {
    question: "Copy करने के लिए शॉर्टकट क्या है?",
    a: "Ctrl + X",
    b: "Ctrl + C",
    c: "Ctrl + V",
    d: "Ctrl + Z",
    correct: "b"
  },
  {
    question: "Redo करने का शॉर्टकट क्या है?",
    a: "Ctrl + Z",
    b: "Ctrl + Y",
    c: "Ctrl + R",
    d: "Ctrl + T",
    correct: "b"
  },
  {
    question: "Text का रंग बदलने का विकल्प कहाँ होता है?",
    a: "Paragraph",
    b: "Font",
    c: "Styles",
    d: "Editing",
    correct: "b"
  },
  {
    question: "Clipboard में कुल कितने आइटम स्टोर हो सकते हैं?",
    a: "12",
    b: "24",
    c: "36",
    d: "48",
    correct: "b"
  },
  {
    question: "Text को 'Left Align' करने का शॉर्टकट क्या है?",
    a: "Ctrl + R",
    b: "Ctrl + L",
    c: "Ctrl + E",
    d: "Ctrl + J",
    correct: "b"
  },
  {
    question: "Insert Tab में किस विकल्प से चित्र जोड़ा जाता है?",
    a: "Table",
    b: "Picture",
    c: "Shapes",
    d: "WordArt",
    correct: "b"
  },
  {
    question: "Insert Tab में Page Number जोड़ने का विकल्प कहाँ होता है?",
    a: "Header & Footer",
    b: "Symbols",
    c: "Illustrations",
    d: "Pages",
    correct: "a"
  },
  {
    question: "Header और Footer Insert Tab के किस ग्रुप में आते हैं?",
    a: "Pages",
    b: "Tables",
    c: "Text",
    d: "Header & Footer",
    correct: "d"
  },
  {
    question: "Insert Tab में कौन-सा विकल्प SmartArt जोड़ने के लिए होता है?",
    a: "Tables",
    b: "Illustrations",
    c: "Text",
    d: "Links",
    correct: "b"
  },
  {
    question: "WordArt Insert करने का विकल्प किस ग्रुप में है?",
    a: "Media",
    b: "Symbols",
    c: "Text",
    d: "Links",
    correct: "c"
  },
  {
    question: "Hyperlink जोड़ने का विकल्प कौन-सा है?",
    a: "Text",
    b: "Links",
    c: "Tables",
    d: "Media",
    correct: "b"
  },
  {
    question: "Bookmark जोड़ने का विकल्प कहाँ होता है?",
    a: "Tables",
    b: "Links",
    c: "Media",
    d: "Text",
    correct: "b"
  },
  {
    question: "Cover Page किस ग्रुप में पाया जाता है?",
    a: "Pages",
    b: "Tables",
    c: "Text",
    d: "Media",
    correct: "a"
  },
  {
    question: "Shapes Insert करने के लिए किस ग्रुप का उपयोग होता है?",
    a: "Illustrations",
    b: "Text",
    c: "Tables",
    d: "Pages",
    correct: "a"
  },
  {
    question: "Table Insert करने का विकल्प कहाँ होता है?",
    a: "Pages",
    b: "Tables",
    c: "Illustrations",
    d: "Text",
    correct: "b"
  },
  {
    question: "Insert Tab में 'Equation' और 'Symbol' किस ग्रुप में होते हैं?",
    a: "Text",
    b: "Symbols",
    c: "Media",
    d: "Links",
    correct: "b"
  },
  {
    question: "Online Pictures जोड़ने का विकल्प कहाँ होता है?",
    a: "Illustrations",
    b: "Links",
    c: "Text",
    d: "Pages",
    correct: "a"
  },
  {
    question: "Insert Tab में किस ग्रुप में Chart जोड़ा जाता है?",
    a: "Illustrations",
    b: "Text",
    c: "Media",
    d: "Tables",
    correct: "a"
  },
  {
    question: "Insert Tab में Screenshot जोड़ने का विकल्प होता है:",
    a: "Text",
    b: "Tables",
    c: "Illustrations",
    d: "Media",
    correct: "c"
  },
  {
    question: "Insert Tab में Video Insert करने का विकल्प किसमें होता है?",
    a: "Media",
    b: "Text",
    c: "Pages",
    d: "Illustrations",
    correct: "a"
  },
  {
    question: "File Tab का मुख्य कार्य क्या है?",
    a: "Formatting",
    b: "Document प्रबंधन",
    c: "Spelling Check",
    d: "Table जोड़ना",
    correct: "b"
  },
  {
    question: "File Tab में 'Save As' का कार्य क्या है?",
    a: "पुराने फाइल को खोलना",
    b: "फाइल को नए नाम से सेव करना",
    c: "फाइल डिलीट करना",
    d: "फॉर्मेटिंग करना",
    correct: "b"
  },
  {
    question: "File Tab में 'Print' का कार्य क्या है?",
    a: "Document delete",
    b: "Document preview",
    c: "Document को प्रिंट करना",
    d: "फॉर्मेटिंग करना",
    correct: "c"
  },
  {
    question: "File Tab में कौन-सा विकल्प हाल ही में खुले Documents को दिखाता है?",
    a: "Save",
    b: "Open",
    c: "Info",
    d: "Recent",
    correct: "d"
  },
  {
    question: "File Tab में 'New' का उपयोग होता है:",
    a: "फॉर्मेट बदलने के लिए",
    b: "नया Document बनाने के लिए",
    c: "Text को Delete करने के लिए",
    d: "फाइल को बंद करने के लिए",
    correct: "b"
  },
  {
    question: "MS Word में फाइल को PDF में सेव करने के लिए कौन-सा विकल्प चुनते हैं?",
    a: "Export",
    b: "Share",
    c: "Save",
    d: "Info",
    correct: "a"
  },
  {
    question: "File Tab में 'Info' विकल्प किसके लिए उपयोग होता है?",
    a: "Table Info दिखाने के लिए",
    b: "File Properties और Permissions के लिए",
    c: "Formatting के लिए",
    d: "Text Input के लिए",
    correct: "b"
  },
  {
    question: "File Tab में 'Options' का उपयोग किसलिए होता है?",
    a: "Text Styling",
    b: "Word Settings को बदलने के लिए",
    c: "Insert Image",
    d: "Hyperlink बनाने के लिए",
    correct: "b"
  },
  {
    question: "File Tab में फाइल को क्लाउड में सेव करने का विकल्प क्या है?",
    a: "Export",
    b: "Share",
    c: "Save As",
    d: "Open",
    correct: "b"
  },
  {
    question: "MS Word को बंद करने का विकल्प कहाँ होता है?",
    a: "File > Close",
    b: "Home > Exit",
    c: "View > Quit",
    d: "Insert > Remove",
    correct: "a"
  }
];


// Allowed Learner Codes
const validLearnerCodes = ["7841", "9298", "9108", "5305", "1747", "3830", "7912", "2719", "2020", "5655", "7929", "7274", "4664", "4130", "2413", "3249", "5836", "9853", "9852"]; // Yahan apne learner codes add karo

// DOM Elements
const loginForm = document.getElementById('loginForm');
const quizSection = document.getElementById('quizSection');
const marksheet = document.getElementById('marksheet');
const answerEls = document.querySelectorAll('.answer');
const questionEl = document.getElementById('question');
const a_text = document.getElementById('a_text');
const b_text = document.getElementById('b_text');
const c_text = document.getElementById('c_text');
const d_text = document.getElementById('d_text');
const submitBtn = document.getElementById('submit');
const studentName = document.getElementById('studentName');
const studentEmail = document.getElementById('studentEmail');
const learnerCode = document.getElementById('learnerCode');
const timerElement = document.getElementById('timer');
const resetButton = document.getElementById('resetButton');
const marksheetName = document.getElementById('marksheetName');
const marksheetEmail = document.getElementById('marksheetEmail');
const marksheetCode = document.getElementById('marksheetCode');
const marksheetScore = document.getElementById('marksheetScore');
const studentTableBody = document.getElementById('studentTableBody');

let currentQuiz = 0;
let score = 0;
let shuffledQuizData = [];
let timeLeft = 30;
let timerInterval;

// Shuffle function
function shuffle(array) {
  let currentIndex = array.length, randomIndex;
  while (currentIndex != 0) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }
  return array;
}

// Handle Login and Store Data
function handleLogin() {
  const name = studentName.value.trim();
  const email = studentEmail.value.trim();
  const learnerCodeValue = learnerCode.value.trim();

  if (name && email && learnerCodeValue) {

    // ✅ Learner code validation
    if (!validLearnerCodes.includes(learnerCodeValue)) {
      alert("गलत Learner Code. कृपया सही कोड दर्ज करें।");
      return;
    }

    // Store user data in sessionStorage
    sessionStorage.setItem('studentName', name);
    sessionStorage.setItem('studentEmail', email);
    sessionStorage.setItem('learnerCode', learnerCodeValue);

    // Hide login and show quiz section
    loginForm.style.display = 'none';
    quizSection.style.display = 'block';

    // Set marksheet fields
    marksheetName.value = name;
    marksheetEmail.value = email;
    marksheetCode.value = learnerCodeValue;

    // Shuffle quiz data and load quiz
    shuffledQuizData = shuffle([...quizData]);
    loadQuiz();
  } else {
    alert("कृपया सभी फ़ील्ड्स भरें।");
  }
}

// Load Quiz Data
function loadQuiz() {
  deselectAnswers();
  const currentQuizData = shuffledQuizData[currentQuiz];
  questionEl.innerText = `Q${currentQuiz + 1}: ${currentQuizData.question}`;
  a_text.innerText = currentQuizData.a;
  b_text.innerText = currentQuizData.b;
  c_text.innerText = currentQuizData.c;
  d_text.innerText = currentQuizData.d;

  timeLeft = 30;
  updateTimer();
  startTimer();
}

// Deselect Answers
function deselectAnswers() {
  answerEls.forEach(answerEl => (answerEl.checked = false));
}

// Get Selected Answer
function getSelected() {
  let answer;
  answerEls.forEach(answerEl => {
    if (answerEl.checked) {
      answer = answerEl.id;
    }
  });
  return answer;
}

// Start Timer
function startTimer() {
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    if (timeLeft > 0) {
      timeLeft--;
      updateTimer();
    } else {
      clearInterval(timerInterval);
      currentQuiz++;
      if (currentQuiz < shuffledQuizData.length) {
        loadQuiz();
      } else {
        showMarksheet();
      }
    }
  }, 1000);
}

// Update Timer
function updateTimer() {
  timerElement.innerText = `Time: ${timeLeft}s`;
  if (timeLeft <= 5) {
    timerElement.classList.add('warning');
  } else {
    timerElement.classList.remove('warning');
  }
}

// Submit Answer
submitBtn.addEventListener('click', () => {
  const answer = getSelected();
  if (answer) {
    if (answer === shuffledQuizData[currentQuiz].correct) {
      score++;
    }
    currentQuiz++;
    if (currentQuiz < shuffledQuizData.length) {
      loadQuiz();
    } else {
      showMarksheet();
    }
  } else {
    alert("कृपया उत्तर चुनें।");
  }
});

// Show Marksheet
function showMarksheet() {
  clearInterval(timerInterval);
  quizSection.style.display = 'none';
  marksheet.style.display = 'block';

  // Set score in marksheet
  marksheetScore.value = `आपने ${score}/${shuffledQuizData.length} प्रश्न सही उत्तर दिए।`;

  // Add record to student records table
  const row = document.createElement('tr');
  row.innerHTML = `
    <td>${sessionStorage.getItem('studentName')}</td>
    <td>${sessionStorage.getItem('studentEmail')}</td>
    <td>${sessionStorage.getItem('learnerCode')}</td>
    <td>${score}</td>
  `;
  studentTableBody.appendChild(row);
}

// Reset Quiz
function resetQuiz() {
  loginForm.style.display = 'block';
  marksheet.style.display = 'none';
  studentName.value = '';
  studentEmail.value = '';
  learnerCode.value = '';
  score = 0;
  currentQuiz = 0;
  clearInterval(timerInterval);
  timerElement.innerText = 'Time: 30s';
}

// Event Listeners
document.getElementById('loginButton').addEventListener('click', handleLogin);
resetButton.addEventListener('click', resetQuiz);
